/**
 * (c) Use It Better, http://useitbetter.com
 */
(function(e){"use strict";var t={result:[],tests:{"Element.addEventListener":function(){return"addEventListener"in e},"Date.now":function(){return"now"in e.Date},"String.trim":function(){return"trim"in e.String.prototype},JSON:function(){return"JSON"in e},localStorage:function(){return"localStorage"in e},sessionStorage:function(){return"sessionStorage"in e},"Canvas.getContext":function(){return"getContext"in e.document.createElement("canvas")}},check:function(){var e;for(e in this.tests){if(this.tests.hasOwnProperty(e)&&this.tests[e]()===false){this.result.push(e)}}return this.result.length===0},getResult:function(){return this.result.join(", ")}};if(t.check()){var n=function(e){var t={META_ACTION:"Action",META_SECTION:"Section",META_ERROR:"Error",META_SITE_IS_READY:"Site is ready",_version:"uDash JS 1.1.7",_status:["notready","setup","ready","connected","teardown"][0],_defaults:{_assetsPath:e.location.protocol==="https:"?"https://1.l.useitbetter.com/html_includes/":"http://1.l.useitbetter.com/html_includes/",_apiUrl:"http://api.useitbetter.com/",_apiUrlSSL:"https://api.l.useitbetter.com/",uDumpProtocole:"https:",uDumpDomain:"l.useitbetter.com",uDumpMethod:"pushFileAppendData.php",uProjectName:"",uPort:"",uProjectApiPass:"",uRecordInteractiveEvents:true,uRecordFormSubmit:true,uRecordHashChange:true,uRecordParamsChange:false,uRecordUrlChange:true,uCompressDump:true,uRecordOnlyOnMobile:false,uRecordPointerChange:200,uFullElementBacktrace:false,uPackageLimit:40,uSendTimeout:10,uShowConsoleMessages:false,uShowEventsTraceInConsole:true,uUseDefaultPanelOpener:true,uEmptySendLimit:30,uRecordAjax:false,uDotSize:28,uHeatMapOpacity:190,uHeatMapGradient:{.05:"#35267b",.1:"#3f1e7b",.15:"#49087f",.2:"#5c0872",.25:"#78085d",.3:"#91084c",.35:"#a7083c",.4:"#b8082f",.45:"#ca0822",.5:"#d61119",.55:"#d73319",.6:"#d75919",.65:"#d78219",.7:"#d7a919",.75:"#d7ba1a",.8:"#d7cc1c",.85:"#d7d446",.9:"#d7d479",.95:"#d7d4ae",1:"#d7d4e5"},uHeatMapStyles:{},uAjaxCacheFlag:"cacheFromUser",uSkipTimeThreshold:7,uWrapperSelector:"",onReady:function(){},onConnected:function(){},onTeardown:function(){},onDumpSend:function(){}},_failedRequestRetry:2,_failedRequests:0,_isIE9:e.navigator.userAgent.indexOf("MSIE 9")>-1,_isIE9Mobile:e.navigator.userAgent.indexOf("MSIE 9")>1&&e.navigator.userAgent.indexOf("Mobile")>1,_isTouchSupported:"ontouchstart"in e,_recordsSeparator:"\n",_lstorage:{},_sstorage:{},_winEventListenerCapture:{},_docEventListenerCapture:{},_htmlEventListenerCapture:{},_UStorage:function(){var t=function(e){this.storageObject=e};t.prototype={set:function(e,t){var n,r;if(typeof e==="object"){n=e;for(r in n){if(n.hasOwnProperty(r)){this.set(r,n[r])}}}else{if(e.match(/^uDash\./)){e=e.replace("uDash.","")}return this.storageObject.setItem("uDash."+e,t)}},get:function(e){return this.storageObject.getItem("uDash."+e)},remove:function(e){return this.storageObject.removeItem("uDash."+e)},makeBackup:function(t,n,r){var i,s={},o=[],u="",a="";o=e.name.split("%p%"+r+"%p%");for(i in this.storageObject){if(i.match(/^uDash\./)){s[i]=this.storageObject.getItem(i)}}if(o.length>1){u=o[0]+"%p%"+r+"%p%";a=o[1].substr(o[1].indexOf("%e%"),o[1].length-1);e.name=u+JSON.stringify(s)+a}else{e.name+="%s%"+[t,n,r,JSON.stringify(s)].join("%p%")+"%e%"}},getBackup:function(t,n,r){var i,s,o=e.name.match(/\%s\%.+\%e\%/)||[],u;for(u=0;u<o.length;u++){i=o[u].split("%s%")[1].split("%e%")[0].split("%p%");if(i.length===4&&i[0]===t&&i[1]==n&&i[2]===r){try{s=JSON.parse(i[3]);return s}catch(a){s={};return false}}}return false},clear:function(e){e=e||{};var t;for(t in this.storageObject){if(t.match(/^uDash\./)){if(!e.except||e.except.indexOf(t.replace("uDash.",""))===-1){this.storageObject.removeItem(t)}}}}};return t}(),_UEventListenerCapture:function(){var e={registered:[],add:function(e,t,n,r){this.registered.push({target:e,name:t,handler:n,useCapture:r})},remove:function(e,t,n){var r;for(r=0;r<this.registered.length;r++){if(this.registered[r].target===e&&this.registered[r].name===t&&this.registered[r].handler===n){this.registered.splice(r,1);return r}}return-1}};var t=function(t){var n=this;this.target=t;this.augmentTarget=typeof t.prototype!=="undefined"&&typeof t.prototype.addEventListener!=="undefined"?t.prototype:t;(function(t,n){t.addEventListener=function(t,r,i,s){if(!s){e.add(this,t,r,i)}return n.call(this,t,r,i)}})(this.augmentTarget,this.augmentTarget.addEventListener);(function(t,n){t.removeEventListener=function(t,r,i){if(!i){e.remove(this,t,r)}return n.call(this,t,r)}})(this.augmentTarget,this.augmentTarget.removeEventListener)};t.prototype={addAll:function(t){var n;for(n=0;n<e.registered.length;n++){if(typeof this.target==="object"&&e.registered[n].target===this.target||typeof this.target==="function"&&e.registered[n].target instanceof this.target){this.target.addEventListener(e.registered[n].name,e.registered[n].handler,e.registered[n].useCapture,true)}}},removeAll:function(){var t;for(t=0;t<e.registered.length;t++){if(typeof this.target==="object"&&e.registered[t].target===this.target||typeof this.target==="function"&&e.registered[t].target instanceof this.target){this.target.removeEventListener(e.registered[t].name,e.registered[t].handler,true)}}}};return t}(),_apiManager:{apiHost:"",apiHostSSL:"",apiProjectAuthKey:"",apiAccountAuthKey:"",projectHash:"",ACCOUNT_LOGIN:"accountauthorization/login",ACCOUNT_PROJECT_LIST:"account/projectList",ACCOUNT_PROJECT_LOGIN:"authorization/login",SESSIONS_LIST_BY_FILTER_SET:"session/listByFilters",FILTERSET_LIST:"filterset/list",HEATMAPS_LIST:"project/getHeatmapsList",SET_SESSION_COMMENT:"session/setComment",STATS_ATTRIBUTES:"session/attributeValuesForKey",STATS_EVENTS:"event/statsByType",getApiUrl:function(){var n=e.location.protocol==="https:",r=t._sstorage.get("uApiUrl");if(r){return r}else if(n){return this.apiHostSSL||t._defaults._apiUrlSSL}else{return this.apiHost||t._defaults._apiUrl}},cache:{data:{},createIndex:function(){return JSON.stringify(Array.prototype.slice.call(arguments))},storeObject:function(){var e=Array.prototype.slice.call(arguments),t=e.shift(),n=this.createIndex.apply(this,e);this.data[n]=t},getObject:function(){var e=this.createIndex.apply(this,Array.prototype.slice.call(arguments));if(this.data.hasOwnProperty(e)){return this.data[e]}else{return false}}},send:function(e){var n=this,r=e.data||{},i;if(typeof e.method!=="string"){t._uConsole.error("API: Specify api call method")}if(this.apiAccountAuthKey&&[this.ACCOUNT_PROJECT_LOGIN,this.ACCOUNT_PROJECT_LIST].indexOf(e.method)>-1){r.apiAccountAuthKey=this.apiAccountAuthKey}else if(this.apiProjectAuthKey&&e.method!==this.ACCOUNT_LOGIN){r.apiAuthKey=this.apiProjectAuthKey}r.getRequest=1;i=this.cache.getObject(e,r);if(e.cache&&e.cache===false||!i){return t._ajax({url:n.getApiUrl()+e.method,method:"POST",data:r,success:function(t){try{t=JSON.parse(t);n.cache.storeObject(t,e,r)}catch(i){t={}}return e.success(t)}})}else if(i){return e.success(i)}}},_propertyNames:{_map:{kC:"keyCode",cX:"clientX",cY:"clientY",pX:"pageX",pY:"pageY",sX:"screenX",sY:"screenY",id:"identifier",t:"touches",tT:"targetTouches",cT:"changedTouches",chk:"checkTag"},_iterator:function(e,t){var n,r,i,s;if(Array.isArray(e)){s=[];for(r=0;r<e.length;r++){if(typeof e[r]==="object"){s[r]=this._iterator(e[r],t)}else{s[r]=e[r]}}}else{s={};for(n in e){if(e.hasOwnProperty(n)){i=t(n);if(typeof e[n]==="object"){s[i]=this._iterator(e[n],t)}else{s[i]=e[n]}}}}return s},getShortName:function(e){var t;for(t in this._map){if(this._map.hasOwnProperty(t)&&this._map[t]===e){return t}}return e},getLongName:function(e){return this._map[e]||e},shorten:function(e){return this._iterator(e,t._bindShim(this.getShortName,this))},expand:function(e){return this._iterator(e,t._bindShim(this.getLongName,this))}},_bindShim:function(){var e=Array.prototype.slice.call(arguments),t=e.shift(),n=e.shift();return function(){return t.apply(n,arguments)}},_selectorMatch:function(t,n,r){if(!r){r=e.document}var i,s=r.querySelectorAll(t);for(i=0;i<s.length;i++){if(s[i]===n){return true}}return false},_extend:function(){var e=Array.prototype.slice.call(arguments),n=e.shift(),r,i,s;for(s=0;s<e.length;s++){r=e[s];for(i in r){if(r.hasOwnProperty(i)){if(typeof r[i]==="object"&&!Array.isArray(r[i])){if(n.hasOwnProperty(i)){n[i]=t._extend(n[i],r[i])}else{n[i]=t._extend({},r[i])}}else{try{n[i]=r[i]}catch(o){}}}}}return n},getStatus:function(){return this._status},_attachEventHandlers:function(t){var n,r,i;for(n in t){if(t.hasOwnProperty(n)){if(n.match(/^doc\_/)){r=e.document;i=n.replace("doc_","")}else if(n.match(/^win\_/)){r=e;i=n.replace("win_","")}else{r=null}if(r){r.addEventListener(i,t[n],true)}}}},_detachEventHandlers:function(t){var n,r,i;for(n in t){if(t.hasOwnProperty(n)){if(n.match(/^doc\_/)){r=e.document;i=n.replace("doc_","")}else if(n.match(/^win\_/)){r=e;i=n.replace("win_","")}else{r=null}if(r){r.removeEventListener(i,t[n])}}}},_getDocumentSize:function(){return{width:e.document.documentElement.scrollWidth,height:e.document.documentElement.scrollHeight}},_getWindowSize:function(){return{width:e.document.documentElement.clientWidth,height:e.document.documentElement.clientHeight}},_getScroll:function(){var t=e.document.documentElement,n=e.document.body;return{x:t&&t.scrollLeft||n&&n.scrollLeft||0,y:t&&t.scrollTop||n&&n.scrollTop||0}},_getDocumentScale:function(){var t=undefined,n=e.document.documentElement.clientWidth,r=e.innerWidth;if(e.orientation){r=screen.width;if(e.orientation==="portrait"){if(screen.width>screen.height){r=screen.height}}else{if(screen.width<screen.height){r=screen.height}}t=r/e.innerWidth}else{t=1}return t},_uConsole:{init:function(n){if(e.console&&n){t._uConsole=e.console}else{t._uConsole={log:function(){},error:function(){},warn:function(){}}}}},_timeouts:{current:{},set:function(t,n,r){var i=this,s=t,o=0;if(typeof this.current[t]==="number"){do{s=t+"."+o;o+=1}while(typeof this.current[s]==="number");t=s}this.current[t]=e.setTimeout(function(){i.clear(t);n()},r)},clear:function(t){if(typeof this.current[t]==="number"){e.clearTimeout(this.current[t]);delete this.current[t]}},clearAll:function(){var e;for(e in this.current){if(this.current.hasOwnProperty(e)){this.clear(e)}}}},_loadCss:function(t,n){var r=e.document.querySelector("body"),i;if(e.document.createStyleSheet){i=e.document.createElement("style");this._ajax({method:"GET",url:n+"getCrossdomain.php?uStylesheetFile="+t,success:function(t){i.appendChild(e.document.createTextNode(t));r.appendChild(i)}})}else{i=e.document.createElement("link");i.setAttribute("rel","stylesheet");i.setAttribute("href",n+t);r.appendChild(i)}},_wrapFinder:{_wrapper:null,_levelLimit:5,_levelRating:[-3,0,-1,-1,-2,-2,-3,-3],_candidates:[],_compareWidth:0,_words:[/wrap/i,/contain/i,/conten/i],_getCompareWidth:function(){var t=e.getComputedStyle(e.document.documentElement),n=e.getComputedStyle(e.document.body);if(t.overflow==="hidden"||n.overflow==="hidden"||t.overflowX==="hidden"||n.overflowX==="hidden"){return e.document.body.clientWidth}else{return e.document.body.scrollWidth}},find:function(){if(!this._wrapper){this._compareWidth=this._getCompareWidth();this._buildCandidates(e.document.documentElement,0);this._candidates.sort(function(e,t){if(e.rating>t.rating){return-1}else if(e.rating<t.rating){return 1}else{return 0}});this._wrapper=this._candidates[0].element}return this._wrapper},_rateElement:function(e,n){var r=0,i=t._getWindowSize(),s=Math.ceil(e.getBoundingClientRect().left+t._getScroll().x),o;if(e.clientWidth<this._compareWidth&&e.clientWidth>this._compareWidth/2||e.clientWidth>i.width){r+=10}if(s===Math.ceil((this._compareWidth-e.clientWidth)/2)||s===Math.ceil((this._compareWidth-e.clientWidth)/2)-1){r+=15}for(o=0;o<this._words.length;o++){if(e.className&&e.className.match(this._words[o])){r+=5}if(e.getAttribute("id")&&e.getAttribute("id").match(this._words[o])){r+=7}}r+=this._levelRating[n];return r},_buildCandidates:function(e,t){var n=e.children,r=0;if(t<this._levelLimit&&n.length>0){for(r=0;r<n.length;r++){if(n[r].nodeType===1){this._candidates.push({element:n[r],rating:this._rateElement(n[r],t)});this._buildCandidates(n[r],t+1)}}}},setWrapper:function(e){this._wrapper=e},getWrapperOffset:function(){return Math.floor(this.find().getBoundingClientRect().left+t._getScroll().x)}},_uParams:{_keysToPreserve:["apiAuthKey"],loadFromUrl:function(){var n="",r={},i={},s;if(e.location.search.indexOf("uParams")>-1){t._sstorage.clear({except:this._keysToPreserve});n=decodeURIComponent(e.location.search.split("uParams=")[1].split("&")[0]);r=n.split("||");for(s=0;s<r.length;s++){i=r[s].split("@@");t._sstorage.set(i[0],i[1])}return true}else{return false}},stripFromUrl:function(e){e=e.replace(/uParams=[a-zA-Z0-9@%\/]+/,"");if(e.indexOf("?#")>-1){e=e.replace("?#","#")}if(e.indexOf("?")===e.length-1){e=e.slice(0,e.length-1)}return e},loadFromJSON:function(e){if(!e.toString||e.toString()!=="[object Object]"){try{e=JSON.parse(e)}catch(n){e={}}}t._sstorage.clear({except:this._keysToPreserve});t._sstorage.set(e)},stringFromObject:function(e){var t,n=[];for(t in e){n.push(t+"@@"+e[t])}return n.join("||")}},_getMetaSectionAutosaveName:function(n){var r=e.location.pathname==="/"?"Home":e.location.pathname,i=e.location.search,s=e.location.hash,o="",u=t._sstorage.get("lastSection")||"";if(r[0]==="/"){r=r.substr(1)}if(r[r.length-1]==="/"){r=r.substr(0,r.length-1)}if(n.uRecordUrlChange){o=r}if(n.uRecordParamsChange&&i){o=r+i}if(n.uRecordHashChange){o+=s}if(o&&u!==o){return o}else{return""}},_prepareUrl:function(e){if(e.indexOf("#")===e.length-1){e=e.slice(0,e.length-1)}return e},_encodePOST:function(e){var t,n,r=[];for(t in e){if(e.hasOwnProperty(t)){n=(e[t]||"").toString();n=encodeURIComponent(n).replace("%20","+");t=encodeURIComponent(t).replace("%20","+");r.push(t+"="+n)}}return r.join("&")},_ajax:function(n){var r,i=n.success||function(){},s=n.error||function(){},o=n.data||{},u=n.url,a=n.method||"POST",f="",l=function(){if(t.getStatus()!=="teardown"){if(t._failedRequests<t._failedRequestRetry){t._failedRequests++;t._ajax(n)}else{s(r)}}};if(a==="POST"){f=t._encodePOST(o)}if("XDomainRequest"in e){r=new XDomainRequest;r.onprogress=function(){};r.onload=function(){i(r.responseText)};r.onerror=function(){l()}}else if("XMLHttpRequest"in e){r=new XMLHttpRequest;r.onreadystatechange=function(){if(r.readyState===4){if(r.status===200){i(r.responseText)}else{l()}}}}else{t._uConsole.error("uDash: no asynchronous transport method available")}r._uibRequest=true;try{r.open(a,u);if(a==="POST"){if(r instanceof XMLHttpRequest){r.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}r.send(f)}else{r.send()}}catch(c){s(r)}return r},__getElementByPath:function(e){var t=document.getElementsByTagName("body")[0];var n=t;if(e.indexOf("#")>-1){var r=e.split("#")[1];if(r.indexOf("/")>-1){r=r.split("/")[0];e=e.substr(e.indexOf("/")+1,e.length)}if(r.indexOf(".")>-1){r=r.split(".")[0]}t=window.document.getElementById(r)}e=e.split("/");if(e.length>0){for(var i=0;i<e.length;i++){var s=e[i].split("[");if(s[1]==null){s[1]=0}else{s[1]=s[1].split("]")[0]*1-1}if(s[0].indexOf(".")>0){var o=s[0].split(".");s[0]=o.shift();s.push(o.join("."))}if(t){n=t;t=t.children[s[1]]}}}return t}};t._lstorage=new t._UStorage(e.localStorage);t._sstorage=new t._UStorage(e.sessionStorage);t._winEventListenerCapture=new t._UEventListenerCapture(e);t._docEventListenerCapture=new t._UEventListenerCapture(e.document);t._htmlEventListenerCapture=new t._UEventListenerCapture(HTMLElement.prototype);return t}(e);var r=function(e){var t=n._extend({},n._defaults),r={x:0,y:0},i={width:0,height:0},s=false,o=false,u=false,a={_eventHandlers:{doc_click:function(e){var t=n._getScroll();g(e.clientX+t.x,e.clientY+t.y);C(e.type,e.timeStamp,e.clientX+t.x,e.clientY+t.y,e.target)},doc_mouseover:function(e){var t=n._getScroll();g(e.clientX+t.x,e.clientY+t.y);C(e.type,e.timeStamp,e.clientX+t.x,e.clientY+t.y,e.target)},doc_mousedown:function(e){var r=n._getScroll();g(e.clientX+r.x,e.clientY+r.y);C(e.type,e.timeStamp,e.clientX+r.x,e.clientY+r.y,e.target);E.send();n._sstorage.makeBackup(t.uProjectName,t.uPort,t.uProjectApiPass)},doc_mouseup:function(e){var t=n._getScroll();g(e.clientX+t.x,e.clientY+t.y);C(e.type,e.timeStamp,e.clientX+t.x,e.clientY+t.y,e.target)},doc_touchstart:function(e){var t=n._getScroll();g(e.changedTouches[0].clientX+t.x,e.changedTouches[0].clientY+t.y);C(e.type,e.timeStamp,e.changedTouches[0].clientX+t.x,e.changedTouches[0].clientY+t.y,e.changedTouches[0].target,n._propertyNames.shorten(b(e)))},doc_touchend:function(e){var t=n._getScroll();g(e.changedTouches[0].clientX+t.x,e.changedTouches[0].clientY+t.y);C(e.type,e.timeStamp,e.changedTouches[0].clientX+t.x,e.changedTouches[0].clientY+t.y,e.changedTouches[0].target,n._propertyNames.shorten(b(e)))},doc_touchcancel:function(e){var t=n._getScroll();g(e.changedTouches[0].clientX+t.x,e.changedTouches[0].clientY+t.y);C(e.type,e.timeStamp,e.changedTouches[0].clientX+t.x,e.changedTouches[0].clientY+t.y,e.changedTouches[0].target,n._propertyNames.shorten(b(e)))},doc_keydown:function(e){var t=e.target.getBoundingClientRect(),r=n._getScroll();if(!u){C(e.type,e.timeStamp,Math.ceil(t.left+e.target.offsetWidth/2+r.x),Math.ceil(t.top+e.target.offsetHeight/2+r.y),e.target,{kC:e.keyCode})}},doc_keyup:function(e){var t=e.target.getBoundingClientRect(),r=n._getScroll();if(!u){C(e.type,e.timeStamp,Math.ceil(t.left+e.target.offsetWidth/2+r.x),Math.ceil(t.top+e.target.offsetHeight/2+r.y),e.target,{kC:e.keyCode})}},doc_submit:function(e){if(t.uRecordFormSubmit){k(n.META_ACTION,"Submitted form: "+M(e.target),false)}},doc_focus:function(t){var r,i;if(t.target===e||t.target===e.document||t.target===e.document.body){if(!s&&!o){E._deleteLastRecordIf(function(e){return e.indexOf("Window Focus")>-1});k("Window Focus",null,false);o=true}}else{if(t.target.tagName&&(t.target.tagName.toLowerCase()==="input"&&["text","email","number","url","tel"].indexOf(t.target.type)>-1||t.target.tagName.toLowerCase()==="textarea"||t.target.tagName.toLowerCase()==="input")){u=true}r=t.target.getBoundingClientRect();i=n._getScroll();C(t.type,t.timeStamp,Math.ceil(r.left+t.target.offsetWidth/2+i.x),Math.ceil(r.top+t.target.offsetHeight/2+i.y),t.target)}},doc_blur:function(t){if((t.target===e||t.target===e.document||t.target===e.document.body)&&o){s=false;E._deleteLastRecordIf(function(e){return e.indexOf("Window Unfocus")>-1});k("Window Unfocus",null,false);o=false}else if(t.target.tagName&&(t.target.tagName.toLowerCase()==="input"&&["text","email","number","url","tel"].indexOf(t.target.type)>-1||t.target.tagName.toLowerCase()==="textarea")){u=false}},doc_change:function(e){var t=e.target.getBoundingClientRect(),r=n._getScroll(),i={};if(e.target.checked){i.chk=1;if(e.target.value!=="on"){i.val=e.target.value}}else{if(["text","email","number","url","tel"].indexOf(e.target.type)>-1||e.target.tagName.toLowerCase()==="textarea"){i.val=d(e.target.value)}else{i.val=e.target.value}}C(e.type,e.timeStamp,Math.ceil(t.left+e.target.offsetWidth/2+r.x),Math.ceil(t.top+e.target.offsetHeight/2+r.y),e.target,i)},win_unload:function(){n._sstorage.makeBackup(t.uProjectName,t.uPort,t.uProjectApiPass)},_manualsend:function(){E.send()},_hashchange:function(t){var r=y(),i=n._getScroll();m();A("e",_(t.timeStamp),r.x+i.x,r.y+i.y,"_uJS","HashChange",e.location.hash)}},IntervaledHandler:function(){var e=function(e){this.timeLimit=parseInt(e.time,10)||100;this.lastTimestamp=0;this.grabTimeoutName=e.name+"Grab";this.save=e.save};e.prototype={handle:function(e,t,r){r=!!r;t=t||{scroll:n._getScroll()};var i=Date.now(),s=this;if(i-this.lastTimestamp>this.timeLimit){this.lastTimestamp=i;this.save(e,t)}if(!r){n._timeouts.clear(this.grabTimeoutName);n._timeouts.set(this.grabTimeoutName,function(){s.handle(e,t,true)},this.timeLimit+20)}}};return e}(),attach:function(t){var r,i,s,u;r=new this.IntervaledHandler({name:"scroll",time:300,save:function(e,t){var n=t.scroll,r=y();if(!o){k("Window Focus",null,false);o=true}A("e",_(e.timeStamp),r.x+n.x,r.y+n.y,"_uJS","Scroll",n.x,n.y)}});s=new this.IntervaledHandler({name:"pointer",time:t.uRecordPointerChange,save:function(e,t){var n=t.scroll;A("p",_(e.timeStamp),e.clientX+n.x,e.clientY+n.y)}});i=new this.IntervaledHandler({name:"resize",time:800,save:function(){w()}});u=new this.IntervaledHandler({name:"touchmove",time:t.uRecordPointerChange,save:function(e,t){var r=t.scroll;C(e.type,e.timeStamp,e.changedTouches[0].clientX+r.x,e.changedTouches[0].clientY+r.y,e.changedTouches[0].target,n._propertyNames.shorten(b(e)))}});this._eventHandlers.win_scroll=this._eventHandlers.win_scroll||n._bindShim(r.handle,r);this._eventHandlers.win_resize=this._eventHandlers.win_resize||n._bindShim(i.handle,i);this._eventHandlers.doc_mousemove=this._eventHandlers.doc_mousemove||function(e){var r=n._getScroll();g(e.clientX+r.x,e.clientY+r.y);if(t.uRecordPointerChange!==false){s.handle(e,{scroll:r})}};this._eventHandlers.doc_touchmove=this._eventHandlers.doc_touchmove||function(e){var r=n._getScroll();g(e.changedTouches[0].clientX+r.x,e.changedTouches[0].clientY+r.y);if(t.uRecordPointerChange!==false){u.handle(e,{scroll:r})}};n._attachEventHandlers(this._eventHandlers);if(t.uRecordHashChange){e.addEventListener("hashchange",this._eventHandlers._hashchange)}if(t.hasOwnProperty("uSendHook")){if(t.uSendHook.nodeType===1){t.uSendHook.addEventListener("click",this._eventHandlers._manualsend,false)}else if(typeof t.uSendHook==="string"&&e.document.querySelector(t.uSendHook).nodeType===1){e.document.querySelector(t.uSendHook).addEventListener("click",this._eventHandlers._manualsend,false)}}},detach:function(t){n._detachEventHandlers(this._eventHandlers);if(t.uRecordHashChange){e.removeEventListener("hashchange",this._eventHandlers._hashchange)}if(t.hasOwnProperty("uSendHook")){if(t.uSendHook.nodeType===1){t.uSendHook.removeEventListener("click",this._eventHandlers._manualsend)}else if(typeof t.uSendHook==="string"&&e.document.querySelector(t.uSendHook).nodeType===1){e.document.querySelector(t.uSendHook).removeEventListener("click",this._eventHandlers._manualsend)}}}},f=function(e){if(typeof n._uConsole.log==="undefined"){n._uConsole.init(e.hasOwnProperty("uShowConsoleMessages")?e.uShowConsoleMessages:n._defaults.uShowConsoleMessages)}if(!e.uProjectName||!e.uPort||!e.uProjectApiPass){n._uConsole.error("uRecorder: Please provide correct uProjectName, uPort and uProjectApiPass");return false}if(n._sstorage.get("sessionLocked")){n._uConsole.error("uRecorder: Recording locked in this session, reason: "+n._sstorage.get("sessionLocked"));return false}if(e.uRecordOnlyOnMobile&&p.any()){n._uConsole.log("uRecorder: recording is currently turned on only on mobile devices");return false}if(n._status==="notready"){n._status="setup";n._uConsole.log('uRecorder: Welcome to uRecorder! Your version is "'+n._version+'". Enjoy developing!');l(e)}else{n._uConsole.log("uRecorder: Already initalized, ignoring init call")}},l=function(r){var s,o=new Date,u=n._getDocumentSize();i=u;t=n._extend(t,r);E._dumpUrl=t.uDumpProtocole+"//"+(t.uPort==="_noport"?"":t.uPort+".")+t.uDumpDomain+"/"+t.uDumpMethod;E._emptySendLimit=t.uEmptySendLimit;if(n._sstorage.get("browsingPageNum")&&n._isIE9?e.history.length===0:e.history.length===1){n._sstorage.clear()}if(!n._sstorage.get("timeOffset")){n._sstorage.set("timeOffset",Date.now())}if(t.uWrapperSelector&&(s=e.document.querySelector(t.uWrapperSelector))&&s.nodeType===1){n._wrapFinder.setWrapper(s)}else{n._wrapFinder.find()}if(!n._sstorage.get("browsingPageNum")){if(!n._lstorage.get("userID")||!n._lstorage.get("userVisit")){x()}else{n._lstorage.set("userVisit",parseInt(n._lstorage.get("userVisit"),10)+1)}I();A("h","o",t.uPort,t.uProjectName,t.uProjectApiPass);L("fsc",[["R",(e.screen.width||"unknown")+"x"+(e.screen.height||"unknkown")].join("="),["L",(e.navigator.language||e.navigator.userLanguage||"").toLowerCase().substr(0,2)||"unknown"].join("=")].join("&"));L("userAgentString",e.navigator.userAgent||"unknown");L("userID",n._lstorage.get("userID"));L("userVisit",n._lstorage.get("userVisit"));L("version",n._version);L("localDateTime",T(o));L("timezoneOffset",o.getTimezoneOffset());L("referer",e.document.referrer||"none");L("playerUrl",n._prepareUrl(e.location.href));setTimeout(P,500);A("e",_(),0,0,"_uJS","LocationChange",e.location.href);v();m();w();E._wasVisitSent=false;n._sstorage.set("browsingPageNum",1);n._sstorage.set("currentUrl",e.location.href)}else{E._locationChange();if(H(e.location.href)){setTimeout(P,500)}A("e",_(),0,0,"_uJS","LocationChange",e.location.href);v();m();w();E._wasVisitSent=true;n._sstorage.set("browsingPageNum",parseInt(n._sstorage.get("browsingPageNum"),10)+1)}a.attach(t);E._setSendTimeout();S();(function(e){XMLHttpRequest.prototype._oldOpen=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(){var n=Array.prototype.slice.call(arguments),r=n[1];if(!this.hasOwnProperty("_uibRequest")){this.addEventListener("readystatechange",function(){var e;if(t.uRecordAjax&&this.readyState===4){e=this.responseText||this.responseHTML||this.responseXML||"";A("s",t.uAjaxCacheFlag,r,"<![CDATA["+e.replace(/\n/g,"\r")+"]]>")}},false)}return e.apply(this,arguments)}})(XMLHttpRequest.prototype.open);n._status="ready";if(t.hasOwnProperty("onReady")&&typeof t.onReady==="function"){t.onReady.call(e.uDash)}if(n._status==="ready"){if(!E._isConnected()){E._connect()}else{c()}}},c=function(){n._status="connected";if(t.hasOwnProperty("onConnected")&&typeof t.onConnected==="function"){t.onConnected.call(e.uDash)}if(t.hasOwnProperty("onDumpSend")&&typeof t.onDumpSend==="function"){E._onSend=t.onDumpSend}},h=function(){var r=n.getStatus(),i;if(r!=="teardown"&&r!=="notready"){n._status="teardown";E._disconnect();a.detach(t);n._timeouts.clearAll();if(typeof XMLHttpRequest.prototype._oldOpen==="function"){XMLHttpRequest.prototype.open=XMLHttpRequest.prototype._oldOpen}n._sstorage.clear({except:["sessionLocked"]});n._sstorage.getBackup(t.uProjectName,t.uPort,t.uProjectApiPass);g(-1e3,-1e3);n._status="notready";if(t.hasOwnProperty("onTeardown")&&typeof t.onTeardown==="function"){t.onTeardown.call(e.uDash)}n._uConsole.log("uRecorder: uRecorder torn down")}},p={Android:function(){return e.navigator.userAgent.match(/Android/i)},BlackBerry:function(){return e.navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return e.navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return e.navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return e.navigator.userAgent.match(/IEMobile/i)},any:function(){return this.Android()||this.BlackBerry()||this.iOS()||this.Opera()||this.Windows()}},d=function(e,t){if(t==undefined)t=0;var n=e.substr(0,t);var r=e.substr(t,e.length);r=r.replace(/[a-zÄ™Ã³Ä…Å›Å‚Å¼ÅºÄ‡Å„]/g,"x");r=r.replace(/[A-ZÄ˜Ã“Ä„ÅšÅÅ»Å¹Ä†Åƒ]/g,"X");r=r.replace(/[0-9]/g,"9");return n+r},v=function(){if(e.document.hasFocus&&e.document.hasFocus()||typeof e.document.hasFocus==="undefined"){k("Window Focus",null,false);s=true;o=true}},m=function(){var e=n._getMetaSectionAutosaveName(t);if(e){var r=n._prepareUrl(decodeURIComponent(e));var i=n._sstorage.get("lastSection");k(n.META_SECTION,r,false)}},g=function(e,t){r.x=e;r.y=t},y=function(){return{x:r.x,y:r.y}},b=function(e){var t={touches:[],targetTouches:[],changedTouches:[]},n=["clientX","clientY","screenX","screenY","pageX","pageY","identifier"],r,i,s;for(r in t){if(t.hasOwnProperty(r)&&e.hasOwnProperty(r)){for(i=0;i<e[r].length;i++){t[r][i]={};for(s=0;s<n.length;s++){if(e[r][i].hasOwnProperty(n[s])){t[r][i][n[s]]=e[r][i][n[s]]}}t[r][i].checkTag=e[r][i].target.tagName.toLowerCase()}}}return t},w=function(){var e=n._getWindowSize(),t=n._getDocumentSize(),r=_(),i=y(),s=n._getScroll();A("e",r,i.x+s.x,i.y+s.y,"_uJS","Viewport",e.width,e.height);A("e",r,i.x+s.x,i.y+s.y,"_uJS","Resize",t.width,t.height);A("e",r,i.x+s.x,i.y+s.y,"_uJS","Scale",n._getDocumentScale());A("e",r,i.x+s.x,i.y+s.y,"_uJS","WrapperOffset",n._wrapFinder.getWrapperOffset())},E={_currentDumpName:"dump",_currentXhr:null,_dumpUrl:"",_emptySendCount:0,_emptySendLimit:Infinity,_wasVisitSent:false,_handleConnection:function(e){var t=e.split("<status>")[1].split("</status>")[0];switch(t){case"ok":if(e.indexOf("token")>-1){var r=e.split("<token>")[1].split("</token>")[0];n._sstorage.set("logDumpToken",r);n._uConsole.log("uRecorder: Recorder connected");c()}else{h()}break;case"error project":h();break;case"out of limits":n._sstorage.set("sessionLocked","server capacity exceeded");h();break;default:h();break}},_onSend:function(){},_locationChange:function(){var e=n._sstorage.get("tempDump")||"";if(e.length>0){n._sstorage.set("tempDump","");n._sstorage.set("dump",e)}},_isConnected:function(){var e=n._sstorage.get("logDumpToken");return e!==null&&e.length>=10},_connect:function(){var e=this;this._currentXhr=n._ajax({url:this._dumpUrl,data:{start:1,project:t.uProjectName},success:function(t){e._currentXhr=null;e._handleConnection(t)},error:function(){e._currentXhr=null;n._uConsole.error("uRecorder: Connection to server failed");h()}})},_disconnect:function(){if(this._currentXhr!==null){this._currentXhr.abort();this._currentXhr=null}},_setTempMode:function(e){var t;if(e){this._currentDumpName="tempDump"}else{this._currentDumpName="dump";t=n._sstorage.get("tempDump")||"";n._sstorage.set("tempDump","");n._sstorage.set("dump",t)}},_getDumpArray:function(){var e=n._sstorage.get(this._currentDumpName);if(e){return e.split(n._recordsSeparator)}else{return[]}},_setDumpByArray:function(e){n._sstorage.set(this._currentDumpName,e.join(n._recordsSeparator))},_newRecord:function(e){var n=this._getDumpArray();n.push(e.join("|"));this._setDumpByArray(n);if(n.length+1>=t.uPackageLimit){this.send()}},_setSendTimeout:function(){var e=this;if(t.uSendTimeout!==false&&!isNaN(parseInt(t.uSendTimeout,10))){n._timeouts.set("dumpTimeout",function(){e.send();e._setSendTimeout()},parseInt(t.uSendTimeout,10)*1e3)}},_deleteLastRecordIf:function(e){var t=this._getDumpArray();if(e(t.pop())){this._setDumpByArray(t)}},_compress:function(e){e=String.fromCharCode(74)+e;var t=function(e){var t,n=[],r=256,i={},s="",o,u;for(t=0;t<256;t++){i[String.fromCharCode(t)]=t}for(t=0,m=e.length;t<m;t++){o=e.charAt(t);u=s+o;if(i[u]){s=u}else{n.push(i[s]);i[u]=r++;s=""+o}}if(s!==""){n.push(i[s])}return n};var n=function(e){var t,n=256,r=[],i=8,s=0,o=0;for(t=0,m=e.length;t<m;t++){s=(s<<i)+e[t];o+=i;n++;if(n>>i){i++}while(o>7){o-=8;r.push(s>>o);s&=(1<<o)-1}}r.push(o?s<<8-o:"");return r};var r=function(e){var t,n=[],r=0,i=0,s="",o;for(t=0,m=e.length;t<m;t++){o=e[t];if(o>127){o-=128;i+=Math.pow(2,r)}if(o===0||o===34||o===37||o===38||o===39||o===43||o===61||o===92){n.push("="+String.fromCharCode(o+16))}else{n.push(String.fromCharCode(o))}r++;if(r>6){if(i===0||i===34||i===37||i===38||i===39||i===43||i===61||i===92){s+="="+String.fromCharCode(i+16)+n.join("")}else{s+=String.fromCharCode(i)+n.join("")}n=[];i=0;r=0}}if(i===0||i===34||i===37||i===38||i===39||i===43||i===61||i===92){s+="="+String.fromCharCode(i+16)+n.join("")}else{s+=String.fromCharCode(i)+n.join("")}return s};var i,s=256,o="",u=0,a=0,f=s,l={},c=[],h="",p="",d,v,m,g,y,b,w;for(i=0;i<s;i++){o+=String.fromCharCode(224)}for(i=0;i<s;i++){l[String.fromCharCode(i)]=i}for(i=0,m=e.length;i<m;i++){g=e.charAt(i);b=g.charCodeAt(0);if(b>255){y=b;switch(b){case 8364:b=128;break;case 8218:b=130;break;case 402:b=131;break;case 8222:b=132;break;case 8230:b=133;break;case 8224:b=134;break;case 8225:b=135;break;case 710:b=136;break;case 8240:b=137;break;case 352:b=138;break;case 8249:b=139;break;case 338:b=140;break;case 381:b=142;break;case 8216:b=145;break;case 8217:b=146;break;case 8220:b=147;break;case 8221:b=148;break;case 8226:b=149;break;case 8211:b=150;break;case 8212:b=151;break;case 732:b=152;break;case 8482:b=153;break;case 353:b=154;break;case 8250:b=155;break;case 339:b=156;break;case 382:b=158;break;case 376:b=159;break}if(y!==b){g=String.fromCharCode(b);a++;u++;if(u>=s){h+=o;u=0}}else{if(u>0){h+=o.substr(0,u);u=0}h+=String.fromCharCode(parseInt(b/256,10))}}else{a++;u++;if(u>=s){h+=o;u=0}}w=p+g;if(l[w]){p=w}else{if(b>255){g=String.fromCharCode(b%256)}c.push(l[p]);l[w]=f++;p=""+g}}if(p!==""){c.push(l[p])}if(u>0){h+=o.substr(0,u)}d=r(n(c));if(e.length!==a){v=r(n(t(h)));return d+"=="+v}else{return d}},send:function(){var r=n._sstorage.get("logDumpToken")||"",i=this,s,o=0,u;if(n._status!=="connected"||this._currentDumpName!=="dump"||this._currentXhr!==null){return false}else{u=this._getDumpArray().length===0;if(u){this._emptySendCount++;if(this._emptySendCount>=this._emptySendLimit){n._uConsole.warn("uRecorder: empty send limit reached, tearing session down");return h()}}else{this._emptySendCount=0}this._currentXhr=new XMLHttpRequest;s=this._getDumpArray().join(n._recordsSeparator);this._setTempMode(true);if(t.uCompressDump===true){s=this._compress(s);o=1}this._currentXhr=n._ajax({url:this._dumpUrl+"?"+"project="+t.uProjectName+"&token="+r,data:{data:s,append:1,compr:o},error:function(){n._uConsole.error("uRecorder: Error while sending log");h()},success:function(t){if(t.split("<status>")[1].split("</status>")[0]==="ok"){i._wasVisitSent=true;i._setTempMode(false);n._timeouts.set("clearDumpXhr",function(){i._currentXhr=null},2e3);if(typeof i._onSend==="function"){i._onSend.call(e.uDash,t)}}else{n._uConsole.error("uRecorder: Error while sending log");h()}}})}}},S=function(){n._timeouts.set("sizeUpdate",function(){var e=n._getDocumentSize(),t=y(),r=n._getScroll();if(i.width!==e.width||i.height!==e.height){A("e",_(),t.x+r.x,t.y+r.y,"_uJS","Resize",e.width,e.height);i=e}S()},500)},x=function(){n._lstorage.set("userID",Math.round(Math.random()*1e9));n._lstorage.set("userVisit",1)},T=function(e){e=e||new Date;var t=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=function(){var t=parseInt(e.getTimezoneOffset(),10)/-60,n="";n+=t;if((t+"").length===1){n="0"+n+"00"}else{n=n+"00"}n=t>0?"+"+n:"-"+n;return n},i=function(e){if((e+"").length===1){return"0"+e}return e};return t[e.getDay()]+" "+n[e.getMonth()]+" "+e.getDate()+" "+i(e.getHours())+":"+i(e.getMinutes())+":"+i(e.getSeconds())+" GMT"+r()+" "+e.getFullYear()},N=function(e){return e!==null&&typeof e!=="undefined"&&e===e},C=function(e,n,r,i,s,o){if(t.uRecordInteractiveEvents){A("e",_(n),r,i,M(s),e,JSON.stringify(o))}},k=function(e,t,r){var i=y(),s=n._getScroll(),o=function(e,t){var r,i,s,o,u;if(e===n.META_SECTION||e===n.META_ACTION){r=parseInt(n._sstorage.get("lastPathTime"),10)||0;i=n._sstorage.get("lastSection")||"";s=n._sstorage.get("pathSaved")==="true"?"":"^^";o=n._sstorage.get("pathTimesSaved")==="true"?"":"^^";u=Math.round(_()/1e3-r);o+=u;if(e===n.META_ACTION){s+="Action="+t;k("Time to "+t,Math.round(_()/1e3),false)}else{s+=t;if(i){k("Time in "+i,u,false)}n._sstorage.set("beforeLastSection",i);n._sstorage.set("lastSection",t)}L("path",s+"^^");L("pathTimes",o+"^^");n._sstorage.set("lastPathTime",Math.round(_()/1e3));n._sstorage.set("pathSaved","true");n._sstorage.set("pathTimesSaved","true")}};if(typeof r==="undefined"){r=true}if(!N(e)){n._uConsole.error("uRecorder: Saving meta event failed, please provide label");return}if(r){n._timeouts.set("saveMeta",function(){o(e,t);A("m",_(),i.x+s.x,i.y+s.y,e,t)},0)}else{o(e,t);A("m",_(),i.x+s.x,i.y+s.y,e,t)}},L=function(e,t){if(!N(e)||!N(t)){n._uConsole.error("uRecorder: Saving attribute failed, please provide label and value");return}A("a",e,t)},A=function(){var e=Array.prototype.slice.call(arguments),r=e.shift(),i=[r],s=["a","h","s"],o,u;if(s.indexOf(r)===-1){u=e.shift();if(u>1e8||u<0){u=_()}i=i.concat([u,e.shift(),e.shift()])}for(o=0;o<e.length;o++){if(typeof e[o]==="undefined"||e[o]===null||e[o]===""){e.splice(o,1)}}i=i.concat(e);if(t.uShowEventsTraceInConsole){if(r!="p"){n._uConsole.log(i)}}E._newRecord(i)},O=function(e,t){var n=e.tagName.toLowerCase(),r,i=1,s;if((e.tagName.toLowerCase()==="li"||t)&&e.parentNode){r=e.parentNode.childNodes.length;for(s=0;s<r;s++){if(e===e.parentNode.childNodes[s]){break}else if(e.parentNode.childNodes[s].nodeType===1){i++}}n+="["+i+"]"}return n+(e.getAttribute("id")?"#"+e.getAttribute("id"):"")+(e.className?"."+e.className.trim().split(/[ \t\n\r]+/).join("."):"")},M=function(e){var n=[],r,i=true;while(e.tagName){r=O(e,i);n.push(r);if(!t.uFullElementBacktrace&&r.indexOf("#")>-1){break}if(e.parentNode){if(e.parentNode.tagName!=="HTML"){e=e.parentNode}else{break}}}n=n.reverse().join("/");return n},_=function(e){e=e||Date.now();return e-parseInt(n._sstorage.get("timeOffset"),10)||0},D=function(e){var t=e+"=";var n=document.cookie.split(";");for(var r=0;r<n.length;r++){var i=n[r];while(i.charAt(0)==" ")i=i.substring(1,i.length);if(i.indexOf(t)==0)return i.substring(t.length,i.length)}return null},P=function(){if(document.cookie){A("e",_(),0,0,"_uJS","setCookie",document.cookie)}},H=function(t){var r=t.split("/");var i=n._sstorage.get("currentUrl");if(i){var s=n._sstorage.get("currentUrl").split("/");n._sstorage.set("currentUrl",e.location.href);if(r[2]!=s[2]){return true}}return false},B=[],j=[],F=[],I=function(){},q=function(e,t,n){},R=function(e,t){},U=function(e,t){if(e===null)return;var r;var i=n.__getElementByPath(e);if(i&&i!=undefined){if(i.value){r=i.value}else{r=i.innerHTML}}else{r=false}if(!r)return"none";if(t==="n"){r=parseInt(r);if(r==="NaN")return"none"}n._uConsole.log("_getElementValueAs: ",r);return r};return{META_ACTION:n.META_ACTION,META_SECTION:n.META_SECTION,META_ERROR:n.META_ERROR,META_SITE_IS_READY:n.META_SITE_IS_READY,init:f,getSetting:function(e){return t[e]||""},getStatus:n._bindShim(n.getStatus,n),tearDown:h,saveAttribute:L,saveMeta:k,sendDump:n._bindShim(E.send,E)}}(e);var i=function(e){var t=e.document.createElement("canvas"),r=e.document.createElement("canvas"),i=t.getContext("2d"),s=r.getContext("2d"),o={},u=null,a=1,f=null,l="",c="dots",h=false,p=n._extend({},n._defaults),d={_dots:null,_lines:null,get:function(){var t,n,r=p.uDotSize/2,i=p.uDotSize/4.6;if(c==="dots"){if(!this._dots){this._dots=e.document.createElement("canvas");this._dots.width=this._dots.height=p.uDotSize;t=this._dots.getContext("2d");n=t.createRadialGradient(this._dots.width/2,this._dots.height/2,i,this._dots.width/2,this._dots.height/2,r);n.addColorStop(0,"rgba(0, 0, 0, 1)");n.addColorStop(1,"rgba(0, 0, 0, 0)");t.fillStyle=n;t.fillRect(0,0,this._dots.width,this._dots.height)}return this._dots}}},v={_hashchange:function(){var e=n._getMetaSectionAutosaveName(p);if(e){S(n.META_SECTION,n._prepareUrl(n._uParams.stripFromUrl(decodeURIComponent(e))))}},win_resize:function(){n._timeouts.clear("heatmapResize");n._timeouts.set("heatmapResize",function(){y();if(l){E()}},300)},win_unload:function(){n._sstorage.makeBackup(p.uProjectName,p.uPort,p.uProjectApiPass)}},m=function(t){if(typeof n._uConsole.log==="undefined"){n._uConsole.init(t.hasOwnProperty("uShowConsoleMessages")?t.uShowConsoleMessages:n._defaults.uShowConsoleMessages)}if(!t.uProjectName||!t.uPort||!t.uProjectApiPass){n._uConsole.error("uHeatMap: Please provide correct uProjectName, uPort and uProjectApiPass");return false}if(n._status==="notready"){n._status="setup";n._uConsole.log('uHeatMap: Welcome to uHeatMap! Your version is "'+n._version+'". Enjoy developing!');if(e.document.readyState==="complete"){g(t)}else{e.addEventListener("load",function(){g(t)},false)}}else{n._uConsole.log("uHeatMap: Already initalized, ignoring init call")}},g=function(r){var i,s,u,h=n._sstorage.get("uHeatMapData"),d=n._sstorage.get("heatMapRawData"),m=function(t){var r,i,s,u,f,h,d,m,g=true;try{r=JSON.parse(t)}catch(y){n._uConsole.error("uHeatMap: Error while parsing JSON heatmap data");w();return}for(i in r){if(r.hasOwnProperty(i)){if(typeof o[i]==="undefined"){o[i]=[]}for(s in r[i]){u=s.split("_");d=parseInt(r[i][s],10);f=parseInt(u[0],10);h=parseInt(u[1],10);if(f>0){g=false}o[i].push({x:f,y:h,hits:d});if(a<d){a=d}}}}if(g){c="lines"}else{c="dots"}if(!l){if(p.uRecordUrlChange||p.uRecordHashChange||p.uRecordUrlChange){m=n._getMetaSectionAutosaveName(p);if(m){S(n.META_SECTION,n._prepareUrl(n._uParams.stripFromUrl(decodeURIComponent(m))))}}}else{E()}n._attachEventHandlers(v);if(p.uRecordHashChange){e.addEventListener("hashchange",v._hashchange)}n._status="ready";if(p.hasOwnProperty("onReady")&&typeof p.onReady==="function"){p.onReady.call(e.uDash)}n._status="connected";if(p.hasOwnProperty("onConnected")&&typeof p.onConnected==="function"){p.onConnected.call(e.uDash)}};if(u=parseInt(n._sstorage.get("uDotSize"),10)){p.uDotSize=u}p=n._extend(p,r);if(p.uWrapperSelector&&(s=e.document.querySelector(p.uWrapperSelector))&&s.nodeType===1){n._wrapFinder.setWrapper(s)}else{n._wrapFinder.find()}t.style.cssText="position: absolute;"+"top: 0px;"+"left: 0px;"+"z-index: 2147483400;"+"pointer-events: none;"+"background-color: rgba(10, 4, 50, 0.4);";for(i in p.uHeatMapStyles){if(p.hasOwnProperty(i)){t.style[i]=p.uHeatMapStyles[i]}}y();b();e.document.querySelector("body").appendChild(t);if(d!==null&&typeof d!=="undefined"){m(d)}else{f=n._ajax({method:"GET",url:p._assetsPath+"getCrossdomain.php?uHeatMapData="+h,success:function(e){n._sstorage.set("heatMapRawData",e);m(e);f=null},error:function(){n._uConsole.error("uHeatMap: Error while retrieving heatmap data");f=null;w()}})}},y=function(){var i,s;t.width=t.height=0;i=n._getDocumentSize();s=n._getWindowSize();t.width=r.width=s.width;t.height=r.height=Math.max(i.height,s.height,e.innerHeight)},b=function(){var e=document.createElement("canvas"),t=e.getContext("2d"),n,r,i;e.width="1";e.height="256";r=t.createLinearGradient(0,0,1,256);n=t.getImageData(0,0,1,1);n.data[0]=n.data[3]=64;n.data[1]=n.data[2]=0;t.putImageData(n,0,0);n=t.getImageData(0,0,1,1);h=n.data[0]<60||n.data[0]>70;for(i in p.uHeatMapGradient){if(p.uHeatMapGradient.hasOwnProperty(i)){r.addColorStop(i,p.uHeatMapGradient[i])}}t.fillStyle=r;t.fillRect(0,0,1,256);u=t.getImageData(0,0,1,256).data},w=function(){var u=n.getStatus();if(u!=="teardown"&&u!=="notready"){n._status="teardown";e.document.querySelector("body").removeChild(t);t=document.createElement("canvas");r=document.createElement("canvas");i=null;s=null;o={};if(f){f.abort()}f=null;n._status="notready";n._sstorage.clear();n._detachEventHandlers(v);if(p.uRecordHashChange){e.removeEventListener("hashchange",v._hashchange)}if(p.hasOwnProperty("onTeardown")&&typeof p.onTeardown==="function"){p.onTeardown.call(e.uDash)}n._uConsole.log("uHeatMap torn down")}},E=function(){var e=l,f,v=typeof o[e]!=="undefined"?o[e].length:0,m,g,y,b,w,E,S,x,T,N,C,k=n._wrapFinder.getWrapperOffset();if(v>0){s.clearRect(0,0,r.width,r.height);if(c==="dots"){for(g=0;g<v;g++){f=o[e][g];y=Math.floor(f.x+k-p.uDotSize/2);b=Math.floor(f.y-p.uDotSize/2);m=d.get();s.globalAlpha=(f.hits/a).toFixed(2);s.drawImage(m,y,b)}}else if(c==="lines"){for(g=0;g<v;g++){f=o[e][g];s.fillStyle="rgba(0, 0, 0, "+(f.hits/a).toFixed(2)+")";s.fillRect(0,f.y-p.uDotSize/2,r.width,p.uDotSize)}}w=s.getImageData(0,0,t.width,t.height);E=s.createImageData(t.width,t.height);N=w.data;C=N.length;for(g=0;g<C;g+=4){if(N[g+3]>0){S=N[g+3];x=S*4;T=Math.pow(S,2)/5<p.uHeatMapOpacity?Math.pow(S,2)/5:p.uHeatMapOpacity;E.data[g]=u[x];E.data[g+1]=u[x+1];E.data[g+2]=u[x+2];if(h){E.data[g]/=255/T;E.data[g+1]/=255/T;E.data[g+2]/=255/T}E.data[g+3]=T}}i.putImageData(E,0,0)}else{s.clearRect(0,0,r.width,r.height);i.clearRect(0,0,t.width,t.height)}},S=function(e,t){if(e===n.META_SECTION){l=t;E()}};return{META_ACTION:n.META_ACTION,META_SECTION:n.META_SECTION,META_ERROR:n.META_ERROR,META_SITE_IS_READY:n.META_SITE_IS_READY,init:m,getSetting:function(e){return p[e]||""},getStatus:n._bindShim(n.getStatus,n),tearDown:w,saveAttribute:function(){},saveMeta:S,sendDump:function(){}}}(e);var s=function(e){var t=function(){var t=function(e){this.data=e;this.data[1]=parseInt(this.data[1],10);this.data[2]=parseInt(this.data[2],10);this.data[3]=parseInt(this.data[3],10)};t.prototype={getType:function(){return this.data[0]},getElementTagFromBacktrace:function(){return this.data[4].substr(this.data[4].lastIndexOf("/")+1).match(/^[a-z]+/)[0]},getTimestamp:function(){return this.data[1]},getCoords:function(){return{x:this.data[2],y:this.data[3]}},handle:function(){var t,r={};switch(this.getType()){case"p":t=this.getCoords();O.dispatch("mousemove",{x:t.x,y:t.y,checkTag:"*"});k.handleEvent("mousemove",t);break;case"m":n._uConsole.log("uPlayer: "+this.data[4]+"="+this.data[5]);if(this.data[4]==="Section"){i=this.data[5]}break;case"e":if(this.data[4]==="_uJS"){if(this.data[5]==="Viewport"){A.post("adjustStageSize",{width:this.data[6],height:this.data[7]})}else if(this.data[5]==="Scroll"){e.scrollTo(this.data[6],this.data[7])}else if(this.data[5]==="Scale"){e.document.body.style.zoom=this.data[6]}else if(this.data[5]==="LocationChange"){w(this.data[6])}else if(this.data[5]==="setCookie"){M(this.data)}}else{t=this.getCoords();if(typeof t.x==="number"&&!isNaN(t.x)&&typeof t.y==="number"&&!isNaN(t.y)){if(typeof this.data[6]!=="undefined"){try{r=JSON.parse(this.data[6])}catch(s){}}r.x=t.x;r.y=t.y;r.checkTag=this.getElementTagFromBacktrace();r.targetPath=this.data[4];r=n._propertyNames.expand(r);O.dispatch(this.data[5],r);k.handleEvent(this.data[5],r)}}break}}};return t}(),r=n._extend({},n._defaults),i="",s=Math.floor(Math.random()*100+1),o={getCurrent:function(){return this._available[this._index]},setIndex:function(e){this._index=e||0},_index:1,_available:[{rate:1,skip:false},{rate:1,skip:true},{rate:2,skip:true},{rate:4,skip:true},{rate:8,skip:true}]},u="<!doctype html>"+"<html>"+"<head>"+'<meta charset="UTF-8">'+'<meta name="viewport" content="width=device-width, initial-scale=1">'+"<title>"+e.document.title+"</title>"+'<script src="%assetsPath%uplayer-wrapper.js"></script>'+'<link rel="stylesheet" href="%assetsPath%uplayer-wrapper.css">'+"</head>"+'<body onready="">'+'<div class="controls"></div>'+'<div class="stage-wrap">'+'<iframe scrolling="no" class="stage" name="stage" width="0" height="0" src="%src%" onload="setTimeout(addMissingUdash,1000);"></iframe>'+"</div>"+"</body>"+"</html>",a="uplayer-stage.css",f=0,l=null,c=false,h=false,p=function(){var t={pointerEvents:false,TouchEvent:false,createTouch:false,createTouchList:false,touchEventModel:"",properTouchList:false},r,i={pointerEvents:function(){var n=e.document.createElement("x"),r=e.document.documentElement,i;if(!("pointerEvents"in n.style)){return false}n.style.pointerEvents="auto";n.style.pointerEvents="x";r.appendChild(n);i=e.getComputedStyle&&e.getComputedStyle(n,"").pointerEvents==="auto";r.removeChild(n);t.pointerEvents=!!i},touchEvents:function(){var r,i;try{r=e.document.createEvent("TouchEvent");t.TouchEvent=true}catch(s){r=document.createEvent("Event")}if("createTouch"in e.document){t.createTouch=true}if("createTouchList"in e.document){t.createTouchList=true}if(t.createTouch&&t.createTouchList){i=e.document.createTouchList([e.document.createTouch(e,e.document.body,1,10,10,10,10),e.document.createTouch(e,e.document.body,2,20,20,20,20)])}else{i=[{clientX:10,clientY:10,identifier:1,pageX:10,pageY:10,screenX:10,screenY:10,target:e.document.body},{clientX:20,clientY:20,identifier:2,pageX:20,pageY:20,screenX:20,screenY:20,target:e.document.body}]}if(t.TouchEvent){try{r.initTouchEvent(i,i,i,"touchstart",e,0,0,0,0,true,false,false,false)}catch(s){}try{if(r.type!=="touchstart"){r.initTouchEvent("touchstart",true,true,e,1,0,0,0,0,false,false,false,false,i,i,i,1,0);if(r.type!=="touchstart"){n._uConsole.warn("unrecognized touch event model");t.TouchEvent=false}else{t.touchEventModel="list-last"}}else{t.touchEventModel="list-first"}}catch(s){}if(r.touches&&r.touches.length>0){t.properTouchList=true}}}};for(r in i){if(i.hasOwnProperty(r)){i[r]()}}return t}(),d=function(e){if(typeof n._uConsole.log==="undefined"){n._uConsole.init(e.hasOwnProperty("uShowConsoleMessages")?e.uShowConsoleMessages:n._defaults.uShowConsoleMessages)}if(!e.uProjectName||!e.uPort||!e.uProjectApiPass){n._uConsole.error("uPlayer: Please provide correct uProjectName, uPort and uProjectApiPass");return false}if(n._status==="notready"){n._status="setup";v(e)}else{n._uConsole.log("uPlayer: Already initalized, ignoring init call")}},v=function(t){var s=function(){var t,i,s,o;if(e===e.top){t=y(function(e,t){if(e.getType()==="e"&&e.data[5]==="LocationChange"){i=t;return true}},1);s=y(function(e,t){if(e.getType()==="e"&&e.data[5]==="setCookie"){o=t;return true}},1);if(e.jQuery){e.jQuery.ready=function(){}}if(e.Zepto){e.Zepto=function(){}}n._winEventListenerCapture.removeAll();n._docEventListenerCapture.removeAll();n._htmlEventListenerCapture.removeAll();if(s&&s.data){P();M(s.data);s.data=""}if(typeof HTMLDocument!=="undefined"){e.document.write=HTMLDocument.prototype.write}else{e.document.write=Document.prototype.write}var f=t.data[6];if(e.document.readyState==="complete"||e.document.readyState==="interactive"){e.document.write(u.replace("%src%",b(f)).replace(/\%assetsPath\%/g,r._assetsPath))}else{e.addEventListener("DOMContentLoaded",function(t){t.stopPropagation();e.document.write(u.replace("%src%",b(f)).replace(/\%assetsPath\%/g,r._assetsPath))},false)}n._sstorage.set("replayIndex",i)}else{A.post("requestSpeedIndex");n._loadCss(a,e.uDash.getSetting("_assetsPath"));(function(e){XMLHttpRequest.prototype._oldOpen=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(){var t=Array.prototype.slice.call(arguments);if(!this.hasOwnProperty("_uibRequest")&&r.uRecordAjax){this._uibOldRequestUrl=t[1];t[0]="POST";t[1]=n._apiManager.getApiUrl()+"storage/get"}return e.apply(this,t)}})(XMLHttpRequest.prototype.open);(function(e){XMLHttpRequest.prototype._oldSend=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.send=function(){var t=Array.prototype.slice.call(arguments);if(this.hasOwnProperty("_uibOldRequestUrl")){this.setRequestHeader("Content-Type","application/x-www-form-urlencoded");t[0]=n._encodePOST({session_hash:n._sstorage.get("uSessionHash"),project_hash:n._sstorage.get("uProjectHash"),object_name:this._uibOldRequestUrl})}return e.apply(this,t)}})(XMLHttpRequest.prototype.send);A.post("init",{sections:y(function(e){return e.getType()==="m"&&e.data[4]===n.META_SECTION}),actions:y(function(e){return e.getType()==="m"&&e.data[4]===n.META_ACTION}),lastRecord:y(function(e,t,n){return t===n-1},1)}).post("setDocumentTitle",{title:e.document.title});k.init(y(function(e){return e.getType()==="e"&&e.data[5].indexOf("touch")>-1},1));n._attachEventHandlers(L);E()}};r=n._extend(r,t);i="";if(n._sstorage.get("recordsRawData")){s()}else{l=n._ajax({method:"POST",url:r._assetsPath+"getCrossdomain.php?replay=true",data:{type:"player",session_hash:n._sstorage.get("uSessionHash"),project_hash:n._sstorage.get("uProjectHash")},success:function(t){var i;try{i=t.split('<?xml version="1.0" encoding="UTF-8" ?><session><![CDATA[')[1].split("]]></session>")[0]}catch(o){n._uConsole.error("uPlayer: wrong replay data");return m()}i=g(i);n._sstorage.set("recordsRawData",i);n._status="ready";if(r.hasOwnProperty("onReady")&&typeof r.onReady==="function"){r.onReady.call(e.uDash)}n._status="connected";if(r.hasOwnProperty("onConnected")&&typeof r.onConnected==="function"){r.onConnected.call(e.uDash)}l=null;s()},error:function(){n._uConsole.error("uPlayer: Error while retrieving session data");l=null;m()}})}},m=function(){n._detachEventHandlers(L)},g=function(e){e=e.split(n._recordsSeparator);var t,r=[],i=[];for(t=0;t<e.length;t++){if(!isNaN(parseInt(e[t].split("|")[1],10))){i.push(e[t])}else{r.push(e[t])}}i=i.sort(function(e,t){var n=parseInt(e.split("|")[1],10),r=parseInt(t.split("|")[1],10);return n-r});return r.concat(i).join(n._recordsSeparator)},y=function(e,r){r=parseInt(r,10)||Infinity;var i=n._sstorage.get("recordsRawData").split(n._recordsSeparator),s,o=i.length,u,a=[];for(s=0;s<o;s++){u=new t(i[s].trim().split("|"));if(e(u,s,o)){a.push(u);if(a.length>=r){break}}}if(r===1){return a[0]}else{return a}},b=function(t){var n="file:///var/mobile/Applications/",r=/\/[A-Z0-9\-]+\//,i,s=e.location.href;if(t.indexOf(n)===0){try{i=s.match(r)[0];t=t.replace(r,i)}catch(o){}}return t},w=function(t){t=b(t);var n=b(e.location.href.substr(0,e.location.href.indexOf("#")>-1?e.location.href.indexOf("#"):e.location.href.length)),r=e.location.hash,i=t.substr(0,t.indexOf("#")>-1?t.indexOf("#"):t.length),s=t.indexOf("#")>-1?t.substr(t.indexOf("#")):"";if(n!==i){T();A.post("lock").post("pause");e.location.href=t}if(r!==s){e.location.hash=s}},E=function(e){var t,r;if(typeof e==="undefined"){t=parseInt(n._sstorage.get("replayIndex"),10)||0}else{t=e;n._sstorage.set("replayIndex",t)}r=y(function(e,n){return n>=t});if(r.length>0){c=false;f=r[0].getTimestamp();n._timeouts.clear("nextRecordPlay");A.post("unlock").post("resume",{resumeTimestamp:r[r.length-1].getTimestamp()});S(r.reverse())}else{C()}},S=function(e){var t;if(!c){if(e.length%5===0){A.post("runFrom",{timeOffset:f})}t=e.pop();n._timeouts.set("nextRecordPlay",function(){f=t.getTimestamp();t.handle();if(e.length>0&&!x()){n._sstorage.set("replayIndex",parseInt(n._sstorage.get("replayIndex"),10)+1);S(e)}else if(e.length===0){C()}},(t.getTimestamp()-f)/o.getCurrent().rate)}else{c=false}},x=function(){var e,t,i=parseInt(n._sstorage.get("replayIndex"),10);if(o.getCurrent().skip===true){e=y(function(e,n){if((e.getType()==="e"||e.getType()==="p"||e.getType()==="m")&&n>i){t=n;return true}else{return false}},1);if(typeof e==="undefined"){C();return true}else if(e.getTimestamp()-f>(parseInt(r.uSkipTimeThreshold,10)*1e3||n._defaults.uSkipTimeThreshold*1e3)){A.post("skip",{skipToTimestamp:e.getTimestamp()});E(t);return true}}return false},T=function(){c=true;n._timeouts.clear("nextRecordPlay")},N=function(){E()},C=function(){if(!h){n._timeouts.clear("nextRecordPlay");A.post("end");h=true}},k={_mouse:null,_touch:[],_mode:"",_supported:["mousemove","mouseover","mouseout","click","mousedown","mouseup","touchstart","touchmove","touchend","touchcancel"],VirtualPointer:function(){var t=function(t){this.type=t.type;this.id=t.id;this.isHidden=false;this.root=this._buildHtml();this.hide();e.document.body.appendChild(this.root)};t.prototype={_buildHtml:function(){var e=document.createElement("div");e.setAttribute("id","udash-virtual-pointer-"+this.id);e.className="udash-virtual-pointer-"+this.type;return e},moveTo:function(e,t){if(this.isHidden){this.show(100)}this.root.style.top=t+"px";this.root.style.left=e+"px"},show:function(e){this.root.style.display="block";this.isHidden=false},hide:function(e){this.root.style.display="none";this.isHidden=true},blink:function(){this.root.className+=" udash-virtual-pointer-blink";var e=this;n._timeouts.set("removeBlink",function(){e.root.className=e.root.className.replace(" udash-virtual-pointer-blink","")},100)}};return t}(),init:function(e){e=!!e;if(e){this._mode="touch"}else{this._mode="mouse";this._mouse=new this.VirtualPointer({type:"mouse",id:-1})}},isSupported:function(e){return this._supported.indexOf(e)!==-1},_getOrCreateTouch:function(e){var t,n;for(t=0;t<this._touch.length;t++){if(this._touch[t].id===e){return this._touch[t]}}n=new this.VirtualPointer({type:"touch",id:e});this._touch.push(n);return n},_destroy:function(t){var n;if(t.type==="touch"){for(n=0;n<this._touch.length;n++){if(this._touch[n]===t){e.document.body.removeChild(this._touch[n].root);this._touch.splice(n,1)}}}},passEvents:function(e){if(!p.pointerEvents){if(e){this.hideAll(0)}else{this.showAll(0)}}},handleEvent:function(e,t){var n,r;if(!this.isSupported(e)){return}if((e.indexOf("mouse")>-1||e==="click")&&this._mode==="mouse"){this._mouse.moveTo(t.x,t.y);if(e==="mousedown"){this._mouse.blink()}}if(e.indexOf("touch")>-1&&this._mode==="touch"){for(n=0;n<t.changedTouches.length;n++){r=this._getOrCreateTouch(t.changedTouches[n].identifier);r.moveTo(t.changedTouches[n].pageX,t.changedTouches[n].pageY);if(e==="touchstart"){r.blink()}else if(e==="touchend"||e==="touchcancel"){this._destroy(r)}}}},hideAll:function(e){var t;if(this._mouse){this._mouse.hide(e)}for(t=0;t<this.touches;t++){this.touches[t].hide(e)}},showAll:function(e){var t;if(this._mouse){this._mouse.show(e)}for(t=0;t<this.touches;t++){this.touches[t].show(e)}},blink:function(e){var t;if(e===0){this._mouse.blink()}else{for(t=0;t<this.touches;t++){if(this.touches[t].id===e){this.touches[t].blink()}}}}},L={win_unload:function(){n._timeouts.clear("nextRecordPlay");A.post("updateUParams",{uParams:{replayIndex:n._sstorage.get("replayIndex"),randomIndex:n._sstorage.get("randomIndex")||-1}});n._sstorage.makeBackup(r.uProjectName,r.uPort,r.uProjectApiPass);A.post("lock").post("pause")},win_message:function(e){A.recieve(e)}},A={post:function(t,r){var i={uDashMessage:true,name:t};if(r){i.params=r}if(e.parent.postMessage){e.parent.postMessage(i,"*")}else{var s=JSON.parse(n._sstorage.get("postMessages"));if(s){s.push(i)}else{s=[i]}n._sstorage.set("postMessages",JSON.stringify(s))}return this},recieve:function(e){var t=e.data;if(t&&t.uDashMessage===true&&typeof t.name==="string"){if(t.name==="setSpeedIndex"){o.setIndex(t.params.speedIndex)}else if(t.name==="ping"){this.post("ping")}else if(t.name==="resume"){N()}else if(t.name==="pause"){T()}}}},O={_supported:["focus","blur","click","mouseover","mouseout","mousedown","mouseup","mousemove","keydown","keyup","keypress","change","touchstart","touchmove","touchend","touchcancel"],_lastMouseoverTarget:null,_lastFocusTarget:null,isSupported:function(e){return this._supported.indexOf(e)!==-1},_createParamsFromData:function(e){var t=["touches","targetTouches","changedTouches"],r={},i=n._getScroll(),s;for(s in e){if(e.hasOwnProperty(s)){if(typeof e.x==="number"){r.clientX=e.x-i.x;r.pageX=e.x}if(typeof e.y==="number"){r.clientY=e.y-i.y;r.pageY=e.y}if(t.indexOf(s)>-1){r[s]=e[s]}}}r.timeStamp=Date.now();return r},_generateTouchList:function(t){var n,r=[];if(p.createTouchList&&p.properTouchList&&false){for(n=0;n<t.length;n++){r.push(e.document.createTouch(e,this._getTarget({x:t[n].clientX,y:t[n].clientY,checkTag:t[n].checkTag}),t[n].identifier,t[n].pageX,t[n].pageY,t[n].screenX,t[n].screenY,t[n].clientX,t[n].clientY))}return e.document.createTouchList(r)}else{for(n=0;n<t.length;n++){r.push({clientX:t[n].clientX,clientY:t[n].clientY,screenX:t[n].screenX,screenY:t[n].screenY,pageX:t[n].pageX,pageY:t[n].pageY,target:this._getTarget({x:t[n].clientX,y:t[n].clientY,checkTag:t[n].checkTag}),identifier:t[n].identifier})}return r}},_createEvent:function(t,n){var r,i,s,o=["touches","targetTouches","changedTouches"];if(t.indexOf("mouse")>-1||t==="click"){r=e.document.createEvent("MouseEvent");r.initMouseEvent(t,true,true,e,0,n.clientX,n.clientY,n.clientX,n.clientY,false,false,false,false,0,null);try{r.timeStamp=n.timeStamp}catch(u){}}else if(t.indexOf("touch")>-1){for(i=0;i<o.length;i++){n[o[i]]=this._generateTouchList(n[o[i]])}if(p.TouchEvent&&false){r=e.document.createEvent("TouchEvent");if(p.touchEventModel==="list-first"){r.initTouchEvent(n.touches,n.targetTouches,n.changedTouches,t,e,n.clientX,n.clientY,n.clientX,n.clientY,true,false,false,false)}else{r.initTouchEvent(t,true,true,e,1,n.clientX,n.clientY,n.clientX,n.clientY,false,false,false,false,n.touches,n.targetTouches,n.changedTouches,1,0)}try{r.timeStamp=n.timeStamp}catch(u){}}else{r=e.document.createEvent("Event");r.initEvent(t,true,true);for(s in n){if(n.hasOwnProperty(s)){try{r[s]=n[s]}catch(u){}}}}}else{r=e.document.createEvent("Event");r.initEvent(t,true,true);for(s in n){if(n.hasOwnProperty(s)){try{r[s]=n[s]}catch(u){}}}}return r},_getTarget:function(t){var r=n._getScroll(),i,s=5,o,u,a=[];k.passEvents(true);if(!i&&t.targetPath&&t.targetPath.indexOf("#")>-1&&t.targetPath.indexOf("/")==-1){u=t.targetPath.split("#")[1];if(u.indexOf("/")==-1){if(u.indexOf(".")>-1){u=u.split(".")[0]}i=e.document.getElementById(u)}}if(t.targetPath&&!i){var f=t.targetPath.split("/");var l=f[f.length-1].replace(/\[.*\]/,"");try{var c=e.document.querySelectorAll(l);if(c.length==1){i=c[0]}}catch(h){}if(!i){i=n.__getElementByPath(t.targetPath)}}if(!i){i=e.document.elementFromPoint(t.x-r.x,t.y-r.y);if(!i||i&&t.checkTag!=="*"&&i.tagName.toLowerCase()!==t.checkTag){a.push(e.document.elementFromPoint(t.x+s-r.x,t.y+s-r.y));a.push(e.document.elementFromPoint(t.x+s-r.x,t.y-s-r.y));a.push(e.document.elementFromPoint(t.x-s-r.x,t.y+s-r.y));a.push(e.document.elementFromPoint(t.x-s-r.x,t.y-s-r.y));for(o=0;o<a.length;o++){if(a[o]&&(t.checkTag==="*"||a[o].tagName.toLowerCase()===t.checkTag)){i=a[o];break}}}}k.passEvents(false);return i},dispatch:function(t,n){var r=this._createParamsFromData(n),i=this._createEvent(t,r),s;if(!this.isSupported(t)){return}if(t==="mouseover"&&this._lastMouseoverTarget&&this._lastMouseoverTarget.nodeType===1){this.dispatch("mouseout",n)}if(t!=="mouseout"){s=this._getTarget(n)}else{s=this._lastMouseoverTarget;n.checkTag=this._lastMouseoverTarget.tagName.toLowerCase()}if(s){if(t==="mouseover"){this._lastMouseoverTarget=s}if(t==="change"){if(n.chk){s.checked=true}if(n.val){s.value=n.val}var o=this._createEvent("blur",{});s.dispatchEvent(i);s.dispatchEvent(o);return}if((t==="mousedown"||t==="click")&&this._lastFocusTarget&&s!==this._lastFocusTarget){this._lastFocusTarget.blur();this._lastFocusTarget=null}if(t==="focus"){this._lastFocusTarget=s;s.focus()}else{if(!(n.checkTag==="select"&&t==="mousedown"&&e.navigator.userAgent.indexOf("WebKit")>-1)){s.dispatchEvent(i)}}}}},M=function(e,t){e.splice(0,5);e=e.join(",");var n=e.split(";");var r=n.length;var i=[];_(i[0],i[1],t)},_=function(t,r,i){n._uConsole.log("uPlayer restore cookie: "+t+"="+r+" in "+i);e.document.cookie=t+"="+r+"; domain="+i+"; path=/"},D=function(t,n){e.document.cookie=t+"=deleted; domain="+n+"; expires=Thu, 2 Aug 2001 20:47:11 UTC; path=/"},P=function(){var t=e.document.cookie.split(";");for(var n=0;n<t.length;n++){var r=t[n];var i=r.indexOf("=");var s=i>-1?r.substr(0,i):r}};return{META_ACTION:n.META_ACTION,META_SECTION:n.META_SECTION,META_ERROR:n.META_ERROR,META_SITE_IS_READY:n.META_SITE_IS_READY,init:d,getSetting:function(e){return r[e]||""},getStatus:n._bindShim(n.getStatus,n),tearDown:m,saveAttribute:function(){},saveMeta:function(){},sendDump:function(){}}}(e);var o={_uDashInitOptions:{},_inject:function(t){if(n._sstorage.get("uDebug")){if(typeof n._uConsole.log==="undefined"){n._uConsole.init(true)}}if(n._sstorage.get("uHeatMapData")){e.uDash=i}else if(n._sstorage.get("uSessionHash")&&n._sstorage.get("uProjectHash")){e.uDash=s}else{e.uDash=r}e.uDash.init.call(e.uDash,t)},_checkMessage:function(t){var r=t.data,i=t.data.params;if(r&&r.uDashMessage===true&&i&&typeof i.uParams==="object"){n._timeouts.clear("publishTimeout");e.removeEventListener("message",o._checkMessage);n._uParams.loadFromJSON(i.uParams);o._inject(o._uDashInitOptions)}},run:function(){var t=this;e.uDash={META_ACTION:n.META_ACTION,META_SECTION:n.META_SECTION,META_ERROR:n.META_ERROR,META_SITE_IS_READY:n.META_SITE_IS_READY,init:function(r){var i;t._uDashInitOptions=r;if(!n._uParams.loadFromUrl()){if(r.uProjectName&&r.uPort&&r.uProjectApiPass&&(i=n._sstorage.getBackup(r.uProjectName,r.uPort,r.uProjectApiPass))){if(i.hasOwnProperty("uDash.browsingPageNum")&&i["uDash.browsingPageNum"]>(n._sstorage.get("browsingPageNum")||0)||!i.hasOwnProperty("uDash.browsingPageNum")){n._sstorage.clear();n._sstorage.set(i);t._inject(r);return}}if(e!==e.top){if(e.location.origin===e.top.location.origin){t._inject(r)}else{e.addEventListener("message",t._checkMessage,false);e.parent.postMessage({uDashMessage:true,name:"requestUParams"},"*");n._timeouts.set("publishTimeout",function(){t._inject(r)},150)}}else{t._inject(r)}}else{n._sstorage.getBackup(r.uProjectName,r.uPort,r.uProjectApiPass);t._inject(r)}},getSetting:function(){return""},getStatus:function(){return"notready"},tearDown:function(){},saveAttribute:function(){},saveMeta:function(){},sendDump:function(){}}}};o.run()}else{if(e.console&&e.console.log){e.console.log("uDash: this browser is incapable of handling uDash properly. Failed support test(s) for: "+t.getResult())}e.uDash={META_ACTION:"",META_SECTION:"",META_ERROR:"",META_SITE_IS_READY:"",init:function(){},getSetting:function(){return""},getStatus:function(){return"incompatible"},tearDown:function(){},saveAttribute:function(){},saveMeta:function(){},sendDump:function(){}}}})(this)
